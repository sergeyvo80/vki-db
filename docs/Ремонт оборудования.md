# Учет заявок на ремонт климатического оборудования

- [Учет заявок на ремонт климатического оборудования](#учет-заявок-на-ремонт-климатического-оборудования)
  - [Описание предметной области](#описание-предметной-области)
    - [Основные функции и возможности модуля включают:](#основные-функции-и-возможности-модуля-включают)
  - [Создание ER диаграммы](#создание-er-диаграммы)
  - [Создание базы данных](#создание-базы-данных)
    - [Тестовые данные](#тестовые-данные)
    - [Запросы](#запросы)
      - [1. Операционные запросы (ежедневная работа)](#1-операционные-запросы-ежедневная-работа)
      - [2. Аналитические запросы (отчетность)](#2-аналитические-запросы-отчетность)
      - [3. Запросы для управления складом](#3-запросы-для-управления-складом)
      - [4. Финансовые запросы](#4-финансовые-запросы)
      - [5. Запросы для клиентского сервиса](#5-запросы-для-клиентского-сервиса)
      - [6. Системные и служебные запросы](#6-системные-и-служебные-запросы)
      - [7. Комплексные бизнес-запросы](#7-комплексные-бизнес-запросы)
  - [Техническое задание на разработку приложения](#техническое-задание-на-разработку-приложения)
      - [1. Общие сведения](#1-общие-сведения)
      - [2. Цель проекта](#2-цель-проекта)
      - [3. Функциональные требования](#3-функциональные-требования)
        - [3.1. Модуль управления клиентами](#31-модуль-управления-клиентами)
        - [3.2. Модуль управления оборудованием](#32-модуль-управления-оборудованием)
        - [3.3. Модуль обработки заявок](#33-модуль-обработки-заявок)
        - [3.4. Модуль исполнения заявок](#34-модуль-исполнения-заявок)
        - [3.5. Модуль управления складом](#35-модуль-управления-складом)
        - [3.6. Модуль отчетности](#36-модуль-отчетности)
      - [4. Технические требования](#4-технические-требования)
        - [4.1. Архитектура приложения](#41-архитектура-приложения)
        - [4.2. Требования к базе данных](#42-требования-к-базе-данных)
        - [4.3. Интерфейс пользователя](#43-интерфейс-пользователя)
    - [5. Детальные требования к функционалу](#5-детальные-требования-к-функционалу)
      - [5.1. Главное окно приложения](#51-главное-окно-приложения)
      - [5.2. Модуль клиентов](#52-модуль-клиентов)
      - [5.3. Модуль заявок](#53-модуль-заявок)
      - [5.4. Модуль исполнения заявок](#54-модуль-исполнения-заявок)
    - [6. Техническая реализация](#6-техническая-реализация)
      - [6.1. Требования к Entity Framework](#61-требования-к-entity-framework)
      - [6.2. Использование SQLCommand](#62-использование-sqlcommand)
      - [6.3. Сервисный слой](#63-сервисный-слой)
      - [7. Требования к коду](#7-требования-к-коду)
      - [7.1. Качество кода](#71-качество-кода)
      - [7.2. Структура проекта](#72-структура-проекта)
    - [8. Критерии приемки](#8-критерии-приемки)
      - [8.1. Обязательные функции](#81-обязательные-функции)
      - [8.2. Дополнительные функции (по желанию)](#82-дополнительные-функции-по-желанию)
    - [9. Этапы выполнения](#9-этапы-выполнения)
      - [Подготовка и базовая структура](#подготовка-и-базовая-структура)
      - [Модуль клиентов и оборудования](#модуль-клиентов-и-оборудования)
      - [Модуль заявок и исполнения](#модуль-заявок-и-исполнения)
      - [Отчетность и финальная доработка](#отчетность-и-финальная-доработка)
    - [10.  Дополнительные указания](#10--дополнительные-указания)
      - [10.1. Настройка подключения к БД](#101-настройка-подключения-к-бд)
      - [10.2. Рекомендуемые NuGet пакеты](#102-рекомендуемые-nuget-пакеты)
      - [10.3. Требования к тестированию](#103-требования-к-тестированию)
      - [10.4  Ожидаемые результаты](#104--ожидаемые-результаты)



## Описание предметной области
Предметная область "Разработка программного модуля для учета заявок на ремонт климатического оборудования" относится к области обслуживания климатического оборудования, такого как кондиционеры, вентиляционные системы, отопительные системы и другое оборудование, необходимое для поддержания комфортных условий в зданиях. Разработка программного модуля для учета заявок на ремонт климатического оборудования предназначена для автоматизации процесса обработки заявок на ремонт со стороны заказчиков, а также для облегчения и ускорения работы сотрудникам, ответственным за обслуживание и ремонт климатического оборудования. Целью разработки программного модуля для учета заявок на ремонт климатического оборудования ожидается повышение эффективности работы и сокращение времени реакции на заявки, улучшение качества обслуживания клиентов и более эффективное планирование ресурсов для выполнения работ по ремонту климатического оборудования.


### Основные функции и возможности модуля включают:
1) Заявка на ремонт: это информация, предоставленная заказчиком о неисправности климатического оборудования, которое требует ремонта. Заказчик оставляет новую заявку. Заявка может содержать данные о типе оборудования, модели, описании проблемы, личную информацию (ФИО клиента и номер телефона). Заказчик может отредактировать свою заявку.
2) Регистрация заявки: этот процесс включает приём и регистрацию заявки оператором сервисной службы в системе учёта. Важными аспектами регистрации являются присвоение уникального идентификатора заявке, сохранение информации о заявке.
3) Обработка заявки: процесс, включающий анализ заявки, определение её приоритетности и назначение исполнителя (специалиста) для ремонта. В процессе обработки может потребоваться дополнительная информация или уточнение деталей проблемы у заказчика.
4) Исполнение заявки: фактическое выполнение ремонта климатического оборудования. На этом этапе назначенный специалист ремонтирует климатическое оборудование, вносит необходимые изменения или заменяет неисправные комплектующие. Важно отметить, что на этом этапе могут возникать необходимость заказа комплектующих или координации работ с другими специалистами.
5) Отчётность и информирование: важной составляющей учёта заявок на ремонт климатического оборудования является фиксация и отчёт о выполненной работе. После завершения ремонта специалист должен предоставить отчёт о проделанной работе, включая информацию о затраченных ресурсах (время, комплектующие) и оказанной помощи.
6) Мониторинг и анализ: этот этап предполагает контроль и анализ процесса учёта заявок на ремонт климатического оборудования. Важно отслеживать и анализировать время обработки заявок, качество выполненных работ, расходы и прочие параметры, которые могут помочь в оптимизации и улучшении процесса.


## Создание ER диаграммы
Разработать ER-диаграмму базы данных для системы учета ремонта оборудования.


## Создание базы данных 
Ознакомиться с [материалом](https://github.com/goryachkinama/db-practice/blob/main/src/Lab0.md)

Написать запросы для создания
- Базы данных
- Все таблицы согласно ER-диаграмме
- Связи между таблицами через внешние ключи
- Индексы для улучшения производительности
- Представление для удобного просмотра заявок

Особенности реализации:
- Использовать IDENTITY(1,1) для автоинкремента первичных ключей
- Добавлены проверки (CHECK) для валидации данных
- Создать индексы на часто используемых полях
- Включить ограничения NOT NULL где это необходимо
- Добавить представление для удобства работы с данными
- Для создание первичного ключа и внешних ключей используйте [CONSTRAINT](https://github.com/goryachkinama/db-practice/blob/main/src/Lab0.md)


### Тестовые данные
Комплексные запросы для заполнения базы данных тестовыми данными, которые отражают реальные бизнес-процессы.

После выполнения скрипта вы получите полностью рабочую базу данных с тестовыми данными для демонстрации и тестирования функциональности системы учета ремонта оборудования.


### Запросы
#### 1. Операционные запросы (ежедневная работа)
- 1.1. Создание новой заявки на ремонт
- 1.2. Назначение специалиста на заявку
- 1.3. Регистрация выполнения работ

#### 2. Аналитические запросы (отчетность)
- 2.1. Статистика по заявкам за текущий месяц
- 2.2. Топ-5 самых частых неисправностей
- 2.3. Рейтинг специалистов по эффективности

#### 3. Запросы для управления складом
- 3.1. Анализ остатков и автоматическое создание заказов
- 3.2. Стоимость запасов на складе

#### 4. Финансовые запросы
- 4.1. Ежемесячная выручка и расходы
- 4.2. Анализ рентабельности по типам оборудования

#### 5. Запросы для клиентского сервиса
- 5.1. История заявок клиента
- 5.2. Анализ отзывов клиентов

#### 6. Системные и служебные запросы
- 6.1. Поиск дублирующихся запчастей
- 6.2. Мониторинг производительности системы
- 6.3. Резервное копирование активных заявок

#### 7. Комплексные бизнес-запросы
- 7.1. Анализ сезонности ремонтов
- 7.2. Прогноз потребности в запчастях




## Техническое задание на разработку приложения
#### 1. Общие сведения
- Наименование проекта: Система учета заявок на ремонт климатического оборудования
- Технологический стек: C#, .NET 8, WPF, Entity Framework (Database First), SQL Server
- Срок выполнения: 4 недели
- Уровень сложности: Средний

#### 2. Цель проекта
- Разработать desktop-приложение для автоматизации процессов учета и обработки заявок на ремонт климатического оборудования, обеспечивающее эффективное управление сервисными операциями.

#### 3. Функциональные требования
##### 3.1. Модуль управления клиентами
- Регистрация новых клиентов
- Просмотр и редактирование информации о клиентах
- Поиск клиентов по ФИО, телефону
- История заявок клиента

##### 3.2. Модуль управления оборудованием
- Добавление оборудования к клиенту
- Редактирование информации об оборудовании
- Просмотр истории ремонтов по оборудованию

##### 3.3. Модуль обработки заявок
- Создание новой заявки на ремонт
- Назначение специалиста на заявку
- Изменение статуса заявки
- Фильтрация заявок по статусу, приоритету, дате
- Добавление комментариев к заявке

##### 3.4. Модуль исполнения заявок
- Регистрация выполненных работ
- Учет затраченного времени
- Учет использованных запчастей
- Расчет стоимости ремонта

##### 3.5. Модуль управления складом
- П#zросмотр остатков запчастей
- Управление минимальными/максимальными уровнями запасов
- Создание заказов на пополнение склада
- Отслеживание статусов заказов

##### 3.6. Модуль отчетности
- Статистика по выполненным заявкам
- Анализ эффективности специалистов
- Финансовая отчетность
- Отчет по остаткам на складе

#### 4. Технические требования
##### 4.1. Архитектура приложения
````
EquipmentRepairApp/
├── Models/ (Entity Framework classes)
├── ViewModels/ (MVVM ViewModels)
├── Views/ (WPF Windows and UserControls)
├── Services/ (Business logic services)
├── Data/ (Database context and repositories)
└── Helpers/ (Utility classes)
````

##### 4.2. Требования к базе данных
- Использование существующей схемы БД из предоставленных SQL-скриптов
- Подход Database First для Entity Framework
- Миграции базы данных не требуются

##### 4.3. Интерфейс пользователя
- WPF с применением паттерна MVVM
- Современный UI с использованием MahApps.Metro или аналогичной библиотеки
- Адаптивный дизайн
- Поддержка русской локализации

### 5. Детальные требования к функционалу
#### 5.1. Главное окно приложения
Требуемые элементы:
- Меню навигации по модулям
- Панель быстрого доступа к часто используемым функциям
- Статусная строка с информацией о пользователе
- Уведомления о новых заявках
#### 5.2. Модуль клиентов
Функционал:
- DataGrid со списком клиентов
- Поисковая строка с фильтрацией
- Кнопки: "Добавить", "Редактировать", "Удалить"
- Форма редактирования клиента
- Вкладка с историей заявок клиента
  
#### 5.3. Модуль заявок
Функционал:
- Список заявок с фильтрами по статусу и дате
- Форма создания/редактирования заявки
- Возможность назначения специалиста
- Изменение статуса заявки
- Добавление комментариев
- 
#### 5.4. Модуль исполнения заявок
- Форма регистрации выполненных работ
- Выбор использованных запчастей из доступных на складе
- Расчет стоимости ремонта
- Добавление комментариев специалиста
- 
### 6. Техническая реализация
#### 6.1. Требования к Entity Framework
````
// Пример конфигурации DbContext
public class EquipmentRepairContext : DbContext
{
    public DbSet<Client> Clients { get; set; }
    public DbSet<Equipment> Equipment { get; set; }
    public DbSet<RepairRequest> RepairRequests { get; set; }
    // ... остальные DbSet
}
````

#### 6.2. Использование SQLCommand
````
// Для сложных запросов использовать прямой SQL
public class ReportService
{
    public DataTable GetMonthlyReport(DateTime startDate, DateTime endDate)
    {
        // Реализация с использованием SqlCommand
    }
}
````

#### 6.3. Сервисный слой
````
// Пример сервиса для работы с заявками
public interface IRepairRequestService
{
    Task<RepairRequest> CreateRequestAsync(RepairRequest request);
    Task<bool> AssignSpecialistAsync(int requestId, int specialistId);
    Task<List<RepairRequest>> GetRequestsByStatusAsync(string status);
}
````

#### 7. Требования к коду
#### 7.1. Качество кода
- Соблюдение принципов SOLID
- Использование async/await для операций с БД
- Валидация входных данных
- Обработка исключений
- Логирование ключевых операций

#### 7.2. Структура проекта
````
EquipmentRepairApp/
├── EquipmentRepairApp.csproj
├── App.xaml
├── MainWindow.xaml
├── Models/
│   ├── Client.cs
│   ├── Equipment.cs
│   └── RepairRequest.cs
├── ViewModels/
│   ├── MainViewModel.cs
│   ├── ClientsViewModel.cs
│   └── RepairRequestsViewModel.cs
├── Views/
│   ├── MainWindow.xaml
│   ├── ClientsView.xaml
│   └── RepairRequestsView.xaml
├── Services/
│   ├── IClientService.cs
│   ├── ClientService.cs
│   └── DatabaseService.cs
├── Data/
│   ├── EquipmentRepairContext.cs
│   └── Config/
└── Helpers/
    ├── RelayCommand.cs
    └── MessageHelper.cs
````

### 8. Критерии приемки
#### 8.1. Обязательные функции
- Приложение успешно компилируется и запускается
- Реализован CRUD для основных сущностей (клиенты, оборудование, заявки)
- Работает фильтрация и поиск данных
- Корректное отображение связанных данных
- Обработка ошибок при работе с БД
#### 8.2. Дополнительные функции (по желанию)
- Генерация отчетов в PDF/Excel
- Система уведомлений
- Ролевая модель доступа
- Резервное копирование данных

### 9. Этапы выполнения
#### Подготовка и базовая структура 
- Настройка проекта .NET 8 WPF
- Подключение Entity Framework (Database First)
- Создание базовых моделей из БД
- Реализация главного окна

#### Модуль клиентов и оборудования
- Реализация CRUD для клиентов
- Модуль управления оборудованием
- Тестирование функционала

#### Модуль заявок и исполнения
- Система обработки заявок
- Модуль регистрации выполненных работ
- Учет запчастей

#### Отчетность и финальная доработка
- Реализация отчетов
- Тестирование приложения
- Документирование кода

### 10.  Дополнительные указания
#### 10.1. Настройка подключения к БД
````
<!-- app.config -->
<connectionStrings>
    <add name="EquipmentRepairContext" 
         connectionString="Data Source=.;Initial Catalog=EquipmentRepairDB;Integrated Security=True" 
         providerName="System.Data.SqlClient" />
</connectionStrings>
````
#### 10.2. Рекомендуемые NuGet пакеты
````
<PackageReference Include="Microsoft.EntityFrameworkCore" Version="8.0.0" />
<PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer" Version="8.0.0" />
<PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="8.0.0" />
<PackageReference Include="MahApps.Metro" Version="2.4.9" />
<PackageReference Include="CommunityToolkit.Mvvm" Version="8.2.1" />
````
#### 10.3. Требования к тестированию
- Ручное тестирование всех функций
- Проверка корректности отображения данных
- Тестирование с различными сценариями данных
- Проверка обработки крайних случаев

#### 10.4  Ожидаемые результаты
- По завершении проекта студент должен предоставить:
- Исходный код приложения
- Скрипты базы данных
- Краткую документацию по запуску
- Демонстрацию работы приложения
- Приложение должно быть готово к использованию и демонстрировать все основные функции системы учета заявок на ремонт климатического оборудования.

